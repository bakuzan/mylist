<section data-ng-controller="HomeController" data-ng-show="authentication.user" data-ng-init="checkStatus();" class="site-wrap" ng-class="{ 'show-nav' : isAddTask }">
    <div class="col-lg-12 col-md-12 col-sm-12 add-task-popout" ng-show="isAddTask">
            <a class="close-button mt" data-ng-click="isAddTask=!isAddTask"><i class="fa fa-times"></i></a>
            <h4 class="popout-header">Add new task</h4>
            <div class="col-md-12 mt">
                <form name="scheduleForm" class="form-horizontal" novalidate>
                <fieldset>
                <div class="form-group">
                    <label for="description" class="col-md-2 control-label">Description</label>
                    <div class="col-md-8">
                        <input type="text" required id="description" class="form-control" placeholder="What do you need to do?" ng-model="newTask">
                    </div>
                </div>
                <div class="form-group">
                    <label for="category" class="col-md-2 control-label">Category</label>
                    <!--<i class="fa fa-caret-down selectArrow"></i>-->
                    <div class="col-md-8">
                        <select required id="category" class="form-control" ng-model="newTaskCategory" ng-options="obj.name for obj in categories">
                            <option class="disabled" value="">Choose a category</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="day" class="col-md-2 control-label">Day</label>
                    <!--<i class="fa fa-caret-down selectArrow"></i>-->
                    <div class="col-md-8">
                        <select required id="day" class="form-control" ng-model="newTaskDay" ng-options="obj.name for obj in days">
                            <option class="disabled" value="">Choose a day</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="date" class="col-md-2 control-label">Date</label>
                    <!--<i class="fa fa-caret-down selectArrow"></i>-->
                    <div class="col-md-8">
                        <input type="date" id="date" class="form-control" ng-model="newTaskDate">
                    </div>
                </div>
                <div class="form-group" ng-hide="newTaskChecklist">
                    <label for="repeat" class="col-md-2 control-label">Repeat</label>
                    <div class="col-md-8">
                        <input type="number" required id="repeat" class="form-control" placeholder="1" ng-model="newTaskRepeat">
                    </div>
                </div>
                <div class="form-group" ng-hide="newTaskChecklist">
                    <label for="daily" class="col-md-2 control-label">Daily?</label>
                    <div class="col-md-8">
                        <input type="checkbox" id="daily" class="form-control" ng-model="newTaskDaily">
                    </div>
                </div>
                <div class="form-group">
                    <label for="checklist" class="col-md-2 control-label">Checklist?</label>
                    <div class="col-md-8">
                        <input type="checkbox" id="checklist" class="form-control" ng-model="newTaskChecklist" ng-change="newTaskChecklist === true ? newTaskRepeat = 1 : newTaskRepeat = 0">
                    </div>
                </div>
                <div class="form-group" ng-show="newTaskChecklist">
                    <label for="checklistOptions" class="col-md-2 control-label">Options</label>
                    <div class="col-md-8">
                        <input type="text" id="checklistOptions" class="form-control" ng-model="newOption" enter-tag="addOption()">
                    </div>
                    <div class="col-md-2 form-group">
                        <a class="btn btn-primary" data-ng-click="addOption()" data-ng-disabled="newOption==='' || newOption===null || newOption===undefined">Add</a>
                    </div>
                </div>
                <div class="form-group" ng-show="newTaskChecklist">
                    <div class="col-md-2"></div>
                    <div class="options-list-container col-md-8">
                        <ul class="options-list">
                            <li class="col-md-12" ng-repeat="option in optionArray track by $index">
                                <a class="bin-style clickable pull-right" aria-hidden="true" ng-click="dropOption(option.text)"><i class="fa fa-trash-o"></i></a>
                                <p>{{option.text}}</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="form-group pull-left">
                    <button class="btn btn-primary" ng-click="addNew()" ng-disabled="scheduleForm.$invalid">Add task</button>
                </div>
                </fieldset>
                </form><!-- </form> -->
            </div><!-- collapse FORM -->
    </div><!-- col-md-12 ACTIONS -->
	<div class="fixed-header">
        <h3>Week Beginning {{ weekBeginning() | dateSuffix }} <button class="btn btn-primary show-actions" ng-init="inTheWay = false" ng-click="inTheWay = !inTheWay">Toggle actions</button></h3>
	</div>
    <div class="container">
        <div class="col-lg-4 col-md-4 col-sm-4 mt filter-container" ng-class="{ 'in-the-way' : inTheWay }">
    <div class="col-lg-12 col-md-12 col-sm-12">
        <a class="menu-header-bar clickable" ng-click="isAddTask=!isAddTask"><i class="fa" ng-class="isAddTask === false ? 'fa-plus-square' : 'fa-minus-square'"></i> Add task</a>
        <a class="menu-header-bar" style="display: none;">Filters</a>
        <div class="col-lg-12 col-md-12 col-sm-12 mt">
            <div class="col-lg-12 col-md-12 col-sm-12 input-group">
		        <div class="input-group-addon">
		          <i class="fa fa-list-ol"></i>
                </div>
                <input type="text" class="form-control" value="Showing {{ filteredTasks.length }} tasks." disabled>
            </div>
            <div class="col-lg-12 col-md-12 col-sm-12 mt input-group">
                <div class="input-group-addon">
                  <i class="fa fa-check-square"></i>
                </div>
                <input type="text" class="form-control" value="{{ (taskItem | filter: {complete: false } | dateFilter: 'current').length }} remaining of {{ (taskItem | dateFilter: 'current').length }} current tasks." disabled>
            </div>
            <div class="col-lg-12 col-md-12 col-sm-12 mt input-group">
                <div class="input-group-addon">
                    <i class="fa fa-search"></i>
                </div>
                <input type="text" class="form-control" placeholder="search tasks" ng-model="search.description">
            </div><!-- search.description -->
            <div class="col-lg-12 col-md-12 col-sm-12 mt input-group">
		       <div class="input-group-addon">
		          <i class="fa fa-check"></i>
                </div>
                <select class="form-control" ng-model="search.complete">
                        <option value="">All</option>
                        <option value="false">Ongoing</option>
                        <option value="true">Completed</option>
                </select>
            </div><!-- search.complete -->
            <div class="col-lg-12 col-md-12 col-sm-12 mt input-group">
		       <div class="input-group-addon">
		          <i class="fa fa-calendar-o"></i>
                </div>
                <select class="form-control" ng-model="daySelected">
                    <option value="">All</option>
                    <option value="Any">Any</option>
                    <option value="1">Monday</option>
                    <option value="2">Tuesday</option>
                    <option value="3">Wednesday</option>
                    <option value="4">Thursday</option>
                    <option value="5">Friday</option>
                    <option value="6">Saturday</option>
                    <option value="0">Sunday</option>
                </select>
            </div><!-- search.days -->
            <div class="col-lg-12 col-md-12 col-sm-12 mt input-group">
		       <div class="input-group-addon">
		          <i class="fa fa-calendar-o"></i>
                </div>
                <select class="form-control" ng-model="datesSelected">
                    <option value="current">Current</option>
                    <option value="future">Future</option>
                </select>
            </div><!-- search.days -->
        </div><!-- collapse FILTERS -->
    </div><!-- col-md-12 FILTERS -->
    </div><!-- col-md-6 ACTIONS+FILTERS -->
        <div class="col-lg-3 col-md-5 col-sm-5 mt placeholder-container"></div>
        <div class="col-lg-8 col-md-6 col-sm-6 mt task-list-container">
            <ul class="taskList col-lg-12 col-md-12 col-sm-12">
                <li class="taskItem" ng-repeat="taskItem in (filteredTasks = (taskItem | filter: search | dayFilter: daySelected | dateFilter: datesSelected)) track by $index" ng-model="taskItem">
                    <input type="checkbox" class="taskCheckbox" ng-model="taskItem.complete" ng-change="save(taskItem.description)" ng-disabled="taskItem.complete || taskItem.checklist">
                    <span class="task-description-text complete-{{taskItem.complete}}" ng-class="taskItem.checklist === true ? 'clickable' : ''" ng-click="taskItem.checklist === true ? viewTask = !viewTask : ''">{{taskItem.description}}</span>
                    <span class="separator"> - </span>
                    <span class="task-times-text complete-{{taskItem.complete}}">{{taskItem.completeTimes}}/{{taskItem.repeat}}</span>
                    <span class="category-{{taskItem.category}}">{{taskItem.category}}</span>
                    <a class="bin-style clickable" aria-hidden="true" ng-click="deleteTask(taskItem.description)">
                        <i class="fa fa-trash-o"></i>
                    </a>
                    <strong class="taskDate complete-{{taskItem.complete}}" hover-data="{{taskItem.date}}">
                        <i class="fa fa-calendar"></i>
                        <span ng-hide="taskItem.daily">{{taskItem.day}}</span>
                        <span ng-show="taskItem.daily">DAILY</span>
                    </strong>
                    <div class="progress-container" hover-data="{{ ((taskItem.checklistOptions | filter: {complete: true}).length / taskItem.checklistOptions.length)*100 | number: 2 }}%"
                         ng-if="taskItem.checklist">
                        <div class="progress checklist-progress-bar" value="((taskItem.checklistOptions | filter: {complete: true}).length / taskItem.checklistOptions.length) * 100">
                            <div class="bar checklist-progress" style="width: {{ ((taskItem.checklistOptions | filter: {complete: true}).length / taskItem.checklistOptions.length) * 100}}%"></div>
                        </div>
                    </div>
                    <div ng-if="taskItem.checklist" class="checklist-list-container" ng-show="viewTask">
                        <input ng-show="!taskItem.complete && addingToChecklist" type="text" class="form-control" ng-model="insertNewOption" enter-tag="insertOption(taskItem.description, insertNewOption); insertNewOption = ''">
                        <a ng-show="!taskItem.complete" class="btn btn-accent" ng-click="addingToChecklist=!addingToChecklist">
                            <i ng-hide="addingToChecklist" class="fa fa-plus"></i>
                            <i ng-show="addingToChecklist" class="fa fa-minus"></i>
                        </a>
                        <a ng-show="!taskItem.complete && addingToChecklist"class="btn btn-accent" ng-click="insertOption(taskItem.description, insertNewOption); insertNewOption = ''" ng-disabled="insertNewOption==='' || insertNewOption===null || insertNewOption===undefined">Add</a>
                        <ul class="checklist-list">
                            <li class="checklist-item" ng-repeat="option in taskItem.checklistOptions track by $index">
                                <input type="checkbox" class="taskCheckbox" ng-model="option.complete" ng-change="tickOff(taskItem.description, option.text)" ng-disabled="option.complete">
                                <span class="complete-{{option.complete}}">{{option.text}}</span>
                            </li>
                        </ul>
                    </div>
                </li>
            </ul>
        </div><!-- TASK ROW -->
    </div>
</section>