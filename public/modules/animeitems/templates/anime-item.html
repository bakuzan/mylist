<div class="md-padding" list-back="{{ctrl.trustAsResourceUrl(animeitem.image)}}">
  <div class="view-item-top">
    <small class="list-group-item-text">
      <time ng-if="animeitem.latest.substring(0,10)===animeitem.meta.updated.substring(0,10)" title="{{animeitem.meta.updated | date: 'yyyy-MMM-dd HH:mm'}}" ng-bind="ctrl.latestDate(animeitem.latest, animeitem.meta.updated)"></time>
      <time ng-if="animeitem.latest.substring(0,10)!==animeitem.meta.updated.substring(0,10)" title="{{animeitem.latest | date: 'yyyy-MMM-dd'}}" ng-bind="ctrl.latestDate(animeitem.latest, animeitem.meta.updated)"></time>
    </small>
    <h4 class="margin-0 cursor-pointer" data-ng-bind="animeitem.title"
        ng-click="(ctrl.whichController === 'watch') ? ctrl.watchAnime(animeitem._id) :
                  (ctrl.filterConfig.viewItem === animeitem) ? ctrl.filterConfig.viewItem = '' : ctrl.filterConfig.viewItem = animeitem"></h4>
    <p class="margin-0">
      <md-button class="md-primary md-icon-button" ng-if="::ctrl.whichController === 'animeitem' && !animeitem.status" ng-click="ctrl.tickOff(animeitem)">
        <md-icon>add_box</md-icon>
      </md-button>
      <span data-ng-bind="animeitem.episodes"></span><span ng-bind="'/' + animeitem.finalEpisode" ng-if="animeitem.finalEpisode !== 0"></span><span> Episodes</span>
      <md-icon ng-if="animeitem.status===true">
        <md-tooltip md-direction="bottom">
          complete
        </md-tooltip>
        check
      </md-icon>
      <md-icon ng-if="animeitem.disc===true">
        <md-tooltip md-direction="bottom">
          own
        </md-tooltip>
        video_library
      </md-icon>
      <md-icon ng-if="animeitem.reWatching===true">
        <md-tooltip md-direction="bottom">
          re-watching
        </md-tooltip>
        repeat
      </md-icon>
    </p>
  </div>
  <div class="view-item-detail" ng-if="::ctrl.whichController !== 'watch'" ng-show="ctrl.filterConfig.viewItem === animeitem">
    <div class="item-detail">
      <p>
        <em class="text-muted" data-ng-if="animeitem.rating==0">No rating.</em>
        <uib-rating data-ng-if="animeitem.rating!=0" data-ng-model="animeitem.rating" class="list-item-rating-stars" read-only="true" max="ctrl.filterConfig.ratingActions.maxRating" id="rating" name="rating"></uib-rating>
      </p>
      <p ng-if="animeitem.reWatchCount!=0">{{animeitem.reWatchCount}} re-watches.</p>
    </div>
    <div class="item-dates">
      <small>
        <span data-ng-bind="animeitem.start | date:'yyyy-MMM-dd'"></span> started.<br/>
        <span ng-if="animeitem.end!==undefined && animeitem.end!==null">{{animeitem.end | date:'yyyy-MMM-dd'}} ended.</span>
      </small>
    </div>
    <md-button class="md-primary" ng-click="ctrl.viewItemHistory()">View history</md-button>
    <div class="item-actions" data-ng-show="((ctrl.authentication.user) && (ctrl.authentication.user._id == animeitem.user._id))">
      <a class="md-button md-accent md-icon-button" href="/#!/animeitems/{{animeitem._id}}">
        <md-tooltip md-direction="bottom">
          view detail
        </md-tooltip>
        <md-icon>pageview</md-icon>
      </a>
      <a class="md-button md-primary md-icon-button" href="/#!/animeitems/{{animeitem._id}}/edit">
        <md-tooltip md-direction="bottom">
          edit item
        </md-tooltip>
        <md-icon>edit</md-icon>
      </a>
    </div>
  </div>
</div>
